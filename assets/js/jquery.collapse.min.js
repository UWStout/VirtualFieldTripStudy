/*
 * Collapse plugin for jQuery
 * --
 * source: http://github.com/danielstocks/jQuery-Collapse/
 * site: http://webcloud.se/jQuery-Collapse
 *
 * @author Daniel Stocks (http://webcloud.se)
 * Copyright 2013, Daniel Stocks
 * Released under the MIT, BSD, and GPL Licenses.
 */
(function(e,t){function n(t,n){n=n||{};var i=this,s=n.query||"> :even";e.extend(i,{$el:t,options:n,sections:[],isAccordion:n.accordion||false,db:n.persist?jQueryCollapseStorage(t.get(0).id):false});i.states=i.db?i.db.read():[];i.$el.find(s).each((function(){new jQueryCollapseSection(e(this),i)}));(function(t){i.$el.on("click","[data-collapse-summary] "+(t.options.clickQuery||""),e.proxy(i.handleClick,t));i.$el.bind("toggle close open",e.proxy(i.handleEvent,t))})(i)}n.prototype={handleClick:function(t,n){t.preventDefault();n=n||"toggle";var i=this.sections,s=i.length;while(s--){if(e.contains(i[s].$summary[0],t.target)){i[s][n]();break}}},handleEvent:function(e){if(e.target==this.$el.get(0))return this[e.type]();this.handleClick(e,e.type)},open:function(e){this._change("open",e)},close:function(e){this._change("close",e)},toggle:function(e){this._change("toggle",e)},_change:function(t,n){if(isFinite(n))return this.sections[n][t]();e.each(this.sections,(function(e,n){n[t]()}))}};function i(t,n){if(!n.options.clickQuery)t.wrapInner('<a href="#"/>');e.extend(this,{isOpen:false,$summary:t.attr("data-collapse-summary",""),$details:t.next(),options:n.options,parent:n});n.sections.push(this);var i=n.states[this._index()];if(i===0){this.close(true)}else if(this.$summary.is(".open")||i===1){this.open(true)}else{this.close(true)}}i.prototype={toggle:function(){this.isOpen?this.close():this.open()},close:function(e){this._changeState("close",e)},open:function(t){var n=this;if(n.options.accordion&&!t){e.each(n.parent.sections,(function(e,t){t.close()}))}n._changeState("open",t)},_index:function(){return e.inArray(this,this.parent.sections)},_changeState:function(t,n){var i=this;i.isOpen=t=="open";if(e.isFunction(i.options[t])&&!n){i.options[t].apply(i.$details)}else{i.$details[i.isOpen?"show":"hide"]()}i.$summary.toggleClass("open",t!=="close");i.$details.attr("aria-hidden",t==="close");i.$summary.attr("aria-expanded",t==="open");i.$summary.trigger(t==="open"?"opened":"closed",i);if(i.parent.db){i.parent.db.write(i._index(),i.isOpen)}}};e.fn.extend({collapse:function(t,i){var s=i?e("body").find("[data-collapse]"):e(this);return s.each((function(){var s=i?{}:t,o=e(this).attr("data-collapse")||"";e.each(o.split(" "),(function(e,t){if(t)s[t]=true}));new n(e(this),s)}))}});t.jQueryCollapse=n;t.jQueryCollapseSection=i;e((function(){e.fn.collapse(false,true)}))})(window.jQuery,window);
